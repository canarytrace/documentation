---
sidebar_position: 3
description: Create a doc page with rich content.
title: Getting Started
tags:
  - rum
---

## Terminologie

**RUM Client**
RUM Client je javascript, kter√Ω zaji≈°≈•uje mƒõ≈ôen√≠ a z√≠sk√°n√≠ dat z browseru a z webov√© aplikace. RUM Client se vkl√°d√° do HTML ≈°ablon, kde m√° b√Ωt RUM Client pou≈æ√≠t. RUM Client z√≠skan√° data odes√≠l√° do RUM Server.

**CRUM**
CRUM je objekt API RUM Client, pokoc√≠ kter√©ho lze RUM Client nastavit. Obsahuje properties a functions.

**Collector**
Collector je proces v RUM Clientovi, kter√Ω v pravideln√Ωch intervalech sb√≠r√° data z API webov√©ho prohl√≠≈æeƒçe. Na konci sv√©ho ≈æivotn√≠ho cyklu data ode≈°le do RUM Server a zaƒç√≠n√° sb√≠rat nov√° dostupn√° data.
- V jak√©m intervalu Collector sb√≠r√° data lze nastavit pomoc√≠ `CRUM.samplingRate`.
- Collector se zastavuje pokud str√°nka nen√≠ del≈°√≠ dobu pou≈æ√≠v√°na. Po jak√© dobƒõ se Collector zastav√≠ lze nastavit pomoc√≠ `CRUM.stopCollectorAfter`.
- Collector se znovu spust√≠, kdy≈æ je str√°nka opƒõt viditeln√°. P≈ôi znovuspu≈°tƒõn√≠ jsou smaz√°ny `session.id`, `session.startTime` and `session.lastLoop` z prohl√≠≈æeƒçe u≈æivatele. N√°slednƒõ se vytvo≈ô√≠ nov√© `session.id`, `session.startTime` a aktualn√≠ `session.lastLoop`

**RUM Server**
RUM Server je backendov√° ƒç√°st, kter√° bƒõ≈æ√≠ v Kubernetesm, vystavuje endpointy, kter√© pou≈æ√≠v√° RUM Client. RUM Server p≈ôij√≠m√° payload s namƒõ≈ôen√Ωmi daty z RUM Client a ukl√°d√° je do Elasticsearch.


## Data

```javascript
const payload = {
  session: {
    id: '123456',
    startTime: 1675377137759,
    lastLoop: 1675377354738,
    duration: 4,
  },
  view: {
    id: 'homepage',
    startTime: 1679327449180, // odstranit, neuzitecne, timestamp je +/- v elasticu
    visit: 0, // 1 poprve (v ramci aktivni session), 2 vicekrat (v ramci aktivni session)
    href: 'https://www.alza.cz/sandisk-ultra-flair?dq=4016974',
    protocol: 'https:',
    host: 'www.alza.cz',
    hostname: 'www.alza.cz',
    port: '',
    pathname: '/sandisk-ultra-flair',
    search: '?dq=4016974',
    hash: '', 
    origin: 'https://www.alza.cz',
    referer: 'https://www.alza.cz/pocitace-a-notebooky',
    longTasks: [
		{
		  duration: 109,
		  name: "self",
		  startTime: 1516
		}
    ],
    resourceTypes: {
      "css": {
          "count": 14
      },
      "javascript": {
          "count": 23
      },
      "image": {
          "count": 57
      },
      "fetch": {
          "count": 15
      },
      "font": {
          "count": 6
      },
      "other": {
          "count": 1
      }
    },
    resources: [
      {
        "name": "https://fonts.googleapis.com/css?family=Roboto:300,400,400i,500,700",
        "entryType": "resource",
        "startTime": 538.4000000003725,
        "duration": 192.80000000074506,
        "initiatorType": "link",
        "nextHopProtocol": "h3",
        "renderBlockingStatus": "non-blocking",
        "workerStart": 0,
        "redirectStart": 0,
        "redirectEnd": 0,
        "fetchStart": 538.4000000003725,
        "domainLookupStart": 553.0999999996275,
        "domainLookupEnd": 553.0999999996275,
        "connectStart": 553.0999999996275,
        "secureConnectionStart": 553.3000000007451,
        "connectEnd": 655.8000000007451,
        "requestStart": 656,
        "responseStart": 728,
        "responseEnd": 731.2000000011176,
        "transferSize": 1087,
        "encodedBodySize": 787,
        "decodedBodySize": 10254,
        "responseStatus": 200,
        "serverTiming": []
      }
    ],
    fps: [
      {
        timeStamp: 18136.59999999404,
        fps: 119
      }
    ],
    marks: [
      {
        'name': 'HE-start-rum',
        'detail': 'Load RUM script from the RUM Server.',
        'startTime': 486
      },
      {
        'name': 'HE-end-rum',
        'detail': '',
        'startTime': 488
      }
    ],
    console: [
      {
        "type": "warn",
        "timeStamp": 892483.7999999821,
        "value": {
          "0": "warn zprava"
        }
      }
    ],
    /*
    analyzersErrors: [],
    */
    actions: [
      {
        "pointerType": "mouse",
        "type": "click",
        "target": "span",
        "timeStamp": 1410.7999999523163,
        "name": "header-order-button"
      }
    ],
    events: [
      {
        "addToBasket": {
          "product": "iPhone",
          "variant": [
            "blue"
          ]
        }
      }
    ],
    visibility: 'visible',
    usedMemory: 35494235 // bytes
  },
  attributes: {
    labels: ['env=dev', 'versionApp=19'],
    browser: 'Firefox',
    browserVersion: '109',
    uaParser: 'userAgent',
    ua: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0'
    connection: {
      effectiveType: '4g', 
      rtt: 50, 
      downlink: 10, 
      saveData: false
    }
    device: {
      type: 'mobile',
      platform: 'Apple',
      memory: 8,
      cpu: 10,
      charging: true
    }
  },
  audits: {
    crossOriginIsolated: false
  },
  metrics: {
    fp: 0,
    fcp: 0,
    cls: 0,
    lcp: 0,
    fid: 3.8000000715255737,
    inp: 0,
    ttfb: 0,
    responseTime: 0,
    domContentLoadedEventStart: 0,
    domContentLoadedEventEnd: 0,
    domContentLoadedDuration: 0,
    renderDuration: 0,
    domComplete: 0,
    duration: 0
  }
}
```

### session 
jsou ukazately aktivity u≈æivatele a odes√≠laj√≠ se na RUM Server v ka≈æd√©m odeslan√©m payloadu.

| attribute name | type | description |
|--|--|--|
|`session.id`|`string`|UUID aktivn√≠ho u≈æivatele, ukl√°d√° se do prohl√≠≈æeƒçe.|
|`session.startTime`|`integer`|Je to ƒçasov√© raz√≠tko vytvo≈ôen√≠ u≈æivatelsk√© relace. Slou≈æ√≠ k urƒçen√≠ d√©lky session. Ukl√°d√° se do prohl√≠≈æeƒçe.|
|`session.lastLoop`|`integer`|Je ƒçasov√© raz√≠tko ka≈æd√©ho loopu collectoru. Pokud je `session.lastLoop` star≈°√≠ pƒõti minut (tzn. za 5min nebylo aktualizov√°no), je vytvo≈ôen√© nov√© `session.id` a `session.startTime`. Ukl√°d√° se do prohl√≠≈æeƒçe.|
|`session.duration`|`integer`|Je d√©lka session v sekund√°ch.

**Session lifecycle**
- P≈ôi prvn√≠ n√°v≈°tƒõvƒõ u≈æivatele na str√°nce je vytvo≈ôeno `session.id` a `session.startTime`. Tyto hodnoty se ulo≈æ√≠ do prohl√≠≈æeƒçe u≈æivatele.
- P≈ôi setrv√°n√≠ u≈æivatele na str√°nce je pravidelnƒõ aktualizov√°no `session.lastLoop` ve smyƒçce podle nastaven√©ho `crum.samplingRate`.
- P≈ôi dal≈°√≠ n√°v≈°tƒõvƒõ str√°nky u≈æivatelem se hodnoty `session.id` a `session.startTime` naƒçtou z prohll√≠≈æeƒçe.
- P≈ôi dal≈°√≠ n√°v≈°tƒõvƒõ str√°nky u≈æivatelem se zjist√≠ ƒças `session.lastLoop` a pokud je star≈°√≠ ne≈æ `crum.newSessionAfter` bude vytvo≈ôeno nov√© `session.id` a `session.startTime`. ƒåasov√© raz√≠tko `session.lastLoop`  nen√≠ aktualizov√°no pokud u≈æivatel str√°nku zav≈ôe, nebo pokud je str√°nka skryta. D√≠ky tomu m≈Ø≈æeme zjistit aktu√°ln√≠ poƒçet aktivn√≠ch u≈æivatel≈Ø a d√©lku ka≈æd√© n√°v≈°tƒõvy s odchylkou p√°r minut. 

**Jak zjistit**
- Poƒçet aktu√°lnƒõ ≈æiv√Ωch session: Vypsat v≈°echny unik√°tn√≠ `session.id`, kter√© nemaj√≠ `session.lastLoop` star≈°√≠ v ≈ô√°dech nƒõkolika minut, nap≈ô√≠klad dvƒõ minuty.
- Jak zjistit d√©lku jedn√© session: Vypsat konkr√©tn√≠ `session.startTime` a n√°slednƒõ `( now-session.startTime )` = v√Ωsledn√Ω ƒças v milisekund√°ch.


### view 
je str√°nka, kterou u≈æivatel proch√°z√≠ a v√°≈æe se ke ka≈æd√©mu payloadu

| attribute name | type | description |
|--|--|--|
|`view.id`|`string`|Automaticky generovan√© UUID str√°nky. UUID je v≈ædy unik√°tn√≠. Lze manu√°lnƒõ nastavit p≈ôi vlo≈æen√≠ RUM Kolektor scriptu do ≈°ablony pomoc√≠ vlastnosti `CRUM.viewId='homePage'` a nebo lze kdykoliv dodateƒçnƒõ nastavit pomoc√≠ `CRUM.setViewId='homePage'`.|
|`view.startTime`|`integer`|Je to ƒçasov√© raz√≠tko otev≈ôen√≠ str√°nky. Je vyu≈æ√≠v√°no k identifikaci poƒçtu n√°≈°tƒõv na konkr√©tn√≠ str√°nku. `view.startTime` je v≈ædy jin√© po nov√©m otev≈ôen√≠ str√°nky.
|`view.href`|`string`|String s celou URL [[Window.location]]|
|`view.protocol`|`string`|String obsahuj√≠c√≠ sch√©ma vƒçetnƒõ `:` [[Window.location]]|
|`view.host`|`string`|Obsahuje n√°zev hostitele a p≈ô√≠padnƒõ i port [[Window.location]]|
|`view.hostname`|`string`|Obsahuje dom√©nu URL adresy [[Window.location]]|
|`view.port`|`string`|Obsahuje port URL adresy [[Window.location]]|
|`view.pathname`|`string`|Obsahuje `/` n√°sledovan√Ω cestou ale bez query [[Window.location]]|
|`view.search`|`string`|Obsahuje `?` n√°sledovan√Ω `querystringem` [[Window.location]]|
|`view.hash`|`string`|Obsahuje `#` n√°sledovan√Ω identifik√°torem fragmentu [[Window.location]]|
|`view.origin`|`string`|Origin [[Window.location]]|
|`view.referer`|`string`|P≈ôedchoz√≠ URL, pokud u≈æivatel p≈ôi≈°el na str√°nku pomoc√≠ odkazu. Pr√°zdn√©, pokud u≈æivatel p≈ôi≈°el na str√°nku p≈ô√≠mo.|
|`view.visibility`|`string`|Viditelnost str√°nky p≈ôi naƒç√≠t√°n√≠. M≈Ø≈æe m√≠t hodnoty `visible` or `hidden` [[Page Visibility API]] Pokud se stav mƒõn√≠, je zaznamen√°n posledn√≠ stav. Visibilita m≈Ø≈æe b√Ωt v r√°mci samplingu i jin√° ne≈æ bƒõhem naƒç√≠t√°n√≠.|
|`view.longTasks`|`array`|Zaznamenan√© tasky a jejich d√©lka. [[üß™ PerformanceLongTaskTiming]]|
|`view.resources`|`array`|Zaznamenan√© navigation a resources z `performance.getEntries()`. [[PerformanceNavigationTiming]] and [[PerformanceResourceTiming]]|
|`view.resourceTypes`|`object`|Seznam zaznamenan√Ωch typ≈Ø resources a jejich poƒçet [[PerformanceResourceTiming#test & snippet]]|
|`view.marks`|`array`|Zaznamen√° v≈°echny `performance.mark`, jejich≈æ n√°zev obsahuje string `HE`. |
|`view.fps`|`array`|Vypoƒç√≠t√°v√° ka≈ædou vte≈ôinu plynulost animac√≠. [[FPS]]|
|`view.console`|`array`|Zachyt√°v√° zpr√°vy z konzole typu `error`, `warn` a `debug`. [[Console]]|
|`view.usedMemory`|`integer`|Vyu≈æit√° pamƒõ≈• webovou aplikac√≠ v bytes. RUM Client se sna≈æ√≠ vyu≈æ√≠t hned dvƒõ api pro p≈ôesn√© zmƒõ≈ôen√≠, ale ne v≈°echny browsery toto mƒõ≈ôen√≠ umo≈æ≈àuj√≠. [[üß™ performance.measureUserAgentSpecificMemory()]]|
|`view.actions`|`array`|Seznam akc√≠, kter√© u≈æivatel provedl. RUM Client hled√° elementy, kter√© maj√≠ atribut `crum-action="name"`. P≈ôi pou≈æit√≠ atributu `crum-send` je zaznamenan√° ud√°lost odesl√°na ihned a nav√≠c se odes√≠laj√≠ i `events`.|
|`view.events`|`array`|Seznam ud√°lost√≠, kter√© m≈Ø≈æete libovolnƒõ bƒõhem ≈æivotn√≠ho cyklu aplikace odes√≠lat p≈ô√≠mo do RUM Clienta pomoc√≠ `CRUM.addEvent()` CRUM Client automaticky p≈ôid√° `timeStamp`.|

**Jak vyhled√°vat v datech**
[[RUM v2 Kibana syntaxe#Vyhled√°v√°n√≠ ve `view` v Kibana]]

**How to use `performance.mark()`**
```html
<!-- hero element is surrounded by the measurement marks -->
<html>
...
<script>performance.mark('HE-start-tailwind')</script>
	<script src="https://cdn.tailwindcss.com"></script>
<script>performance.mark('HE-end-tailwind')</script>

<!-- You can use performance.mark for measure moment when the element was loaded -->
<img src="./img/webperf.webp" onload="performance.mark('HE-main-banner')" alt="Web Performance Testing" width="800" height="424">
...
<body>

<!-- Or measure, when server responsed -->
<script>
	fetch("http://example.com/movies.json")
	  .then((response) => response.json())
	  .then((data) => {
	    performance.mark('HE-response-movies')
	    console.log(data)
	  });
</script>

<!-- you can use in your events -->
<script>
	document.addEventListener("scroll", function handler() {
	    //Remove the event listener so that it only triggers once
	    document.removeEventListener("scroll", handler);
	    // for timestamp for first scroll event
	    performance.mark('HE-first-scroll')
	});
</script>
...
```


**How to user client actions**
values are available in `view.actions`
```javascript
// add crum-action attribute and name to monitored element. The RUM Client record the click on this element.
<span class="font-semibold text-transparent bg-clip-text bg-gradient-to-br from-pink-400 to-red-600" crum-action="header-order-button">Objednat</span>

// immediately send
<span class="font-semibold text-transparent bg-clip-text bg-gradient-to-br from-pink-400 to-red-600" 
crum-action="header-order-button" crum-send>Objednat</span>
```

**How to use addEvent**
```javascript
// first parameter is requires, second param is optional
CRUM.addEvent('best-training', {
  'name': 'webPerf',
  'days': ['MON','THU'],
  'open': true,
})

// or minimal
CRUM.addEvent('addToBasket')
```



### attributes
attributy mƒõ≈ôen√≠

| attribute name | type | description |
|--|--|--|
|`attributes.labels`|`array`|Libovoln√© informace, kter√© se pos√≠laj√≠ s ka≈æd√Ωm payloadem. M≈Ø≈æe obsahovat verzi aplikace, prost≈ôed√≠ a dal≈°√≠ dopl≈àkov√© informace.
|`attributes.browser`|`string`|Vendor browser name. [[UserAgent a detekce za≈ô√≠zen√≠]]|
|`attributes.browserVersion`|`string`|Verze prohl√≠≈æeƒçe. [[UserAgent a detekce za≈ô√≠zen√≠]]|
|`attributes.uaParser`|`string`|Metoda identifikace za≈ô√≠zen√≠ a prohl√≠≈æeƒçe. `userAgent` parsov√°n√≠ z bƒõ≈æn√©ho UA stringu a `userAgentData` je nov√© api, poskytuje identifikaci, ale nen√≠ podporov√°no ve v≈°ech prohl√≠≈æeƒç√≠ch. [[UserAgent a detekce za≈ô√≠zen√≠]]|
|`attributes.ua`|`string`|UA string, kter√© bylo parserem zpracov√°no. [[UserAgent a detekce za≈ô√≠zen√≠]]|
|`attributes.connection.effectiveType`|`string`|Vrac√≠ ≈ôetƒõzec `slow-2g`, `2g`, `3g` nebo `4g`. Vzch√°z√≠ se z posledn√≠ho pozorov√°n√≠ propustnosti downlinku na aplikaƒçn√≠ vrstvƒõ. [[üß™ navigator.connection]]|
|`attributes.connection.rtt`|`integer`|Je doba v¬†_milisekund√°ch_¬†pot≈ôebn√° k odesl√°n√≠ datov√©ho paketu na m√≠sto urƒçen√≠ plus doba, za kterou je paket p≈ôijat zpƒõt na m√≠sto urƒçen√≠. [[üß™ navigator.connection]]|
|`attributes.connection.downlink`|`integer`|Vrac√≠ odhad ≈°√≠≈ôky efektivn√≠ho p√°sma v¬†_megabitech_¬†za sekundu, zaokrouhlen√Ω na nejbli≈æ≈°√≠ n√°sobek 25kilobit≈Ø za sekundu. [[üß™ navigator.connection]]|
|`attributes.connection.saveData`|`boolean`|Vr√°t√≠¬†`true`, pokud u≈æivatel nastavil mo≈ænost sn√≠≈æen√©ho vyu≈æit√≠ dat na u≈æivatelsk√©m agentovi. [[üß™ navigator.connection]]|
|`attributes.device.type`|`string`|`mobile` or `desktop`.|
|`attributes.device.platform`|`string`|N√°zev vendora za≈ô√≠zen√≠, nap≈ô. `Apple`|
|`attributes.device.memory`|`integer`|Dostupn√° pamƒõ≈• v za≈ô√≠zen√≠. Ne v≈°echny prohl√≠≈æeƒçe toto mƒõ≈ôen√≠ podporuj√≠.|
|`attributes.device.cpu`|`integer`|Dostupn√Ω poƒçet dostupn√Ωch logick√Ωch processors pro spu≈°tƒõn√≠ vl√°ken v za≈ô√≠zen√≠.|
|`attributes.device.charging`|`boolean`|`true` Pokud se za≈ô√≠zen√≠ nab√≠j√≠ a `false` pokud se nenab√≠j√≠. V nƒõketer√Ωch prohl√≠≈æeƒç√≠ch nefunguje, proto vrac√≠ `false`|


### audits
proveden√© audity

| audit name | type | description |
|--|--|--|
|`audits.crossOriginIsolated`|`boolean`|Vr√°t√≠ `true` pokud bƒõ≈æ√≠ str√°nka v secure contextu. [[üß™ performance.measureUserAgentSpecificMemory()]]|

### metrics
z√≠skan√© metriky

| attribute name | type | description |
|--|--|--|
|`metrics.fp`|`integer`|ƒåas kdy poprv√© se na obrazovce vykresln√≠ prvn√≠ pixel od zaƒç√°tku navigace. [[FP]]|
|`metrics.fcp`|`integer`|ƒåas, kdy prohl√≠≈æeƒç vykreslil prvn√≠ ƒç√°st obsahu DOMu. [[FCP]]|
|`metrics.cls`|`integer`|Mƒõ≈ôen√≠ vizu√°ln√≠ stability. [[CLS]]|
|`metrics.lcp`|`integer`|ƒåas vyrenderov√°n√≠ nejvƒõt≈°√≠ho obr√°zku nebo textu ve viewportu. [[LCP]]|
|`metrics.fid`|`integer`|Mƒõ≈ô√≠ ƒças mezi prvn√≠ interakc√≠ u≈æivatele a jej√≠m skuteƒçn√Ωm proveden√≠m. [[FID]]|
|`metrics.inp`|`integer`|Tato metrika sleduje vƒõt≈°inu u≈æivatelsk√Ωch interakc√≠ a n√≠zk√© INP znamen√°, ≈æe str√°nka bude reagovat pro vƒõt≈°inu u≈æivatelsk√Ωch interakc√≠. [[WebPerf/Metrics/INP]]|
|`metrics.domComplete`|`integer`|Dokonƒçilo se naƒç√≠t√°n√≠ dokumentu a v≈°ech d√≠lƒç√≠ch zdroj≈Ø. [[PerformanceNavigationTiming]]|
|`metrics.domContentLoadedEventStart`|`integer`|ƒåas bezprost≈ôednƒõ p≈ôedt√≠m, ne≈æ se spust√≠ event handler `DOMContentLoaded`. Na tento okam≈æik zpravidla ƒçekaj√≠ r≈Øzn√© Javascriptov√© knihovny a frameworky. |
|`metrics.domContentLoadedEventEnd`|`integer`|HTML dokument je kompletnƒõ zparsov√°n, v≈°echny deferovan√© skritpy jsou naƒçten√© a spu≈°tƒõn√©. Neƒçek√° se na obr√°zky, iframy a dokonƒçen√≠ async skript≈Ø. [[PerformanceNavigationTiming]]|
|`metrics.domContentLoadedDuration`|`integer`|Jak dlouho trv√° zpracov√°n√≠ `DOMContentLoaded` ud√°losti.|
|`metrics.renderDuration`|`integer`|Doba mezi `loadEventEnd` a `domContentLoadedEventStart`, tedy od zaƒç√°tku zpracov√°v√°n√≠ dokumentu po ud√°lost `loadEventEnd`, tedy cel√° str√°nka je zpracovan√° vƒçetnƒõ sta≈æen√Ωch resources. |
|`metrics.duration`|`integer`|Celkov√° doba navigace, vƒçetnƒõ zpracov√°n√≠ dokumentu.|
|`metrics.ttfb`|`integer`|Doba od zaƒç√°tku navigace po `responseStart`.|
|`metrics.responseTime`|`integer`|Celkov√° doba odes√≠l√°n√≠ odpovƒõdi ze serveru.|

